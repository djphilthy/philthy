<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>philthy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      margin: 0;
      padding: 32px;
      background: #000;
      color: #fff;
      font-family: "Courier New", Courier, monospace;
      font-size: 16px;
      line-height: 1.6;
    }

    a {
      color: #fff;
      text-decoration: none;
      cursor: pointer;
    }

    a:hover {
      text-decoration: underline;
    }

    .container {
      max-width: 720px;
      position: relative;
      z-index: 10; /* Keeps text above video */
    }

    .title {
      font-weight: bold;
      margin-bottom: 24px;
    }

    .track {
      margin-bottom: 6px;
    }

    .player {
      display: none;
      margin-bottom: 14px;
    }

    audio {
      width: 100%;
      height: 28px;
      background: #000;
      filter: invert(1) grayscale(1);
    }

    /* Invert colors for audio player controls to match aesthetic */
    audio::-webkit-media-controls-panel { background: #000; }
    audio::-webkit-media-controls-play-button,
    audio::-webkit-media-controls-timeline,
    audio::-webkit-media-controls-current-time-display,
    audio::-webkit-media-controls-time-remaining-display,
    audio::-webkit-media-controls-mute-button,
    audio::-webkit-media-controls-volume-slider {
      filter: invert(1);
    }

    /* --- VIDEO BACKGROUND STYLES --- */
    #bgVideo {
        position: fixed;
        right: 0;
        bottom: 0;
        min-width: 100%;
        min-height: 100%;
        width: auto;
        height: auto;
        z-index: -2;          /* Behind everything */
        
        /* FIT SETTING: Change 'cover' to 'contain' if you want to see the whole video with black bars */
        object-fit: cover;    
        
        opacity: 0;           /* Start hidden (black) */
        transition: opacity 1.5s ease; /* Smooth fade over 1.5 seconds */
    }

    #bgVideo.visible {
        opacity: 1;
    }

    #videoOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6); /* 60% Darkness overlay to make text readable */
        z-index: -1;          /* Between video and text */
        pointer-events: none; /* Click-through allowed */
    }
  </style>
</head>
<body>

  <video id="bgVideo" muted loop playsinline></video>
  <div id="videoOverlay"></div>

  <div class="container">
    <div class="title">philthy</div>

    <div class="track"><a class="play" data-src="mixes/ORDON U GET.mp3">ORDON U GET.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/HILLBILLY HEART.mp3">HILLBILLY HEART.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/SORT_OF.mp3">SORT_OF.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/FLACKO_NU_GENEA.mp3">FLACKO_NU_GENEA.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/I_RAN_FANETO.mp3">I_RAN_FANETO.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/CHROMOHEAD.mp3">CHROMOHEAD.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/SUNDRESS_ARREST.mp3">SUNDRESS_ARREST.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/ON_SAKURA.mp3">ON_SAKURA.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/STAY_LOCATION.mp3">STAY_LOCATION.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/COP_LIGHTS.mp3">COP_LIGHTS.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/MEGAMAN_EMPIRE.mp3">MEGAMAN_EMPIRE.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>

    <div class="track"><a class="play" data-src="mixes/I_LIKE_TO_STAY_HIGH.mp3">I_LIKE_TO_STAY_HIGH.mp3</a></div>
    <div class="player"><audio controls preload="none"></audio></div>
  </div>

  <script>
    const links = Array.from(document.querySelectorAll("a.play"));
    const allAudios = Array.from(document.querySelectorAll("audio"));
    
    // --- VIDEO SETUP ---
    const bgVideo = document.getElementById("bgVideo");
    
    // Your video files must be in a folder named 'movies'
    const videoList = [
      "movies/IMG_6972.mp4",
      "movies/IMG_6980.mp4",
      "movies/IMG_6782.mp4"
    ];

    function playRandomVideo() {
        // Pick a random video from the list
        const randomVid = videoList[Math.floor(Math.random() * videoList.length)];
        bgVideo.src = randomVid;
        bgVideo.play();
        bgVideo.classList.add("visible"); // Start fade in
    }

    function stopVideo() {
        bgVideo.classList.remove("visible"); // Start fade out
        // Pause video after fade completes (1.5s) to save resources
        setTimeout(() => {
            bgVideo.pause();
        }, 1500); 
    }

    // --- AUDIO & MEDIA SESSION SETUP ---

    function closeAll(except = null) {
      links.forEach(link => {
        if (link === except) return;
        const player = link.parentElement.nextElementSibling;
        if (!player) return;
        const audio = player.querySelector("audio");
        audio.pause();
        audio.removeAttribute("src");
        audio.load();
        player.style.display = "none";
      });
    }

    links.forEach(link => {
      // Setup the audio player next to the link
      const player = link.parentElement.nextElementSibling;
      const audio = player.querySelector("audio");

      // 1. Listen for when the song naturally ends
      audio.onended = () => {
          stopVideo(); // Fade out video
          audio.removeAttribute("src");
          audio.load();
          player.style.display = "none";
      };

      // 2. Handle Clicks
      link.addEventListener("click", e => {
        e.preventDefault();
        const open = player.style.display === "block";

        if (open) {
          // PAUSE ACTION
          stopVideo(); // Fade out video
          audio.pause();
          audio.removeAttribute("src");
          audio.load();
          player.style.display = "none";
          return;
        }

        // PLAY ACTION
        closeAll(link);
        player.style.display = "block";
        audio.src = link.dataset.src;
        
        // Play both audio and video
        audio.play().catch(() => {});
        playRandomVideo();

        // 3. SET LOCK SCREEN INFO (Media Session API)
        if ('mediaSession' in navigator) {
            // Clean up the text: "SONG NAME.mp3" -> "SONG NAME"
            const cleanTitle = link.innerText.replace('.mp3', '');
            
            navigator.mediaSession.metadata = new MediaMetadata({
                title: cleanTitle,
                artist: "Philthy",
                // Album art omitted as requested
            });

            // Add standard lock screen controls
            navigator.mediaSession.setActionHandler('play', () => audio.play());
            navigator.mediaSession.setActionHandler('pause', () => audio.pause());
            navigator.mediaSession.setActionHandler('stop', () => {
                audio.pause();
                stopVideo();
            });
        }
      });
    });
  </script>
</body>
</html>
